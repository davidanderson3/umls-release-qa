<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
    <HEAD>
    <TITLE>
    PDQ_2018_10_27 Inversion Notes
    </TITLE>
    <BODY>
    <PRE>
Source inversion proposal for PDQ_2018_10_27

I.  General

A.  Outstanding issues

B.  New/changed since last inversion.

        New TTY=BN (fully-specified drug brand name that CANNOT be prescribed). Deprecating TTY=BD (fully-specified drug brand name that CAN be prescribed) because the drug names appearing in the 'US brand name' field do not indicate dosage which would be needed to assign TTY=BD.

C.  Estimate of new/changed concepts
	5764 new codes

D.  Notes for insertion

        UMLS semantic types will win upon insertion.

I.  Format of input files:

A.  Pointer to source documentation
        /umls_s/src_root/PDQ_2018_10_27/orig/fromprovider/pdq.dtd

B.  Brief description of the input files

        1.  Individual PDQ xml terminology files.
        2.  Total files received approx. 13,407.
        3.  Each filename begins with CDR*

        Valid fields: (see documentation)
        PreferredName
        NCIMetathesaurusConceptID 
        TermTypeName
        OtherTermName
        OtherNameType
        ID
        ParentTermName
		ParentTermName ref 
        ParentType
        RelatedTermName
		RelatedTermName ref
        RelationshipType
        LegacyPDQID
        SemanticType
        SemanticType ref
        DefinitionText
        DefinitionType
        ExternalRef 
        Date First Published
        Date Last Modified
        MenuParent
        MenuParent ref 
		MenuType
        DisplayName
		MenuItem SortOrder 


III.  Inversion plan:

A.  General notes/comments

Note:  there are PDQ glossary files on the same
ftp site but it is considered a separate source (NCI-GLOSS) from
PDQ Terminology and the two should not be merged per NCI.

Prior to processing, run the files through charfreq.pl to verify UTF8
formatting:  'cat &#60file&#62| charfreq.pl -8'. (cat CDR3*.xml &#62 test)

Run 'show-examples.pl -c &#60unicode&#62 &#60filename&#62' to see samples of
non-ascii characters. (show-examples.pl -c U+2022 test | m)

Need to verify that all the IDs are valid.

Scripts removed duplicate atoms and attributes.  See section 'IV. Data
Problems' for examples.


Classes_atoms.src:
------------------

Mapping:

Abbreviation    		| AB
Acronym         		| ACR
Chemical structure name 	| CHN
Chemical code name     		| CCN
Common usage    		| CU
DisplayName 			| ET
Foreign brand name 		| FBD
Header term              	| HT
Lexical variant 	 	| LV
Obsolete name   		| IS
Obsolete term   	 	| OP
PreferredName            	| PT
  empty termtypename field 	| PT
Protocol selection criteria 	|PSC
Synonym         	 	| SY
US brand name   		| BN

'OtherTermName' terms with an 'OtherNameType' of 'Broader'or
'Subtype'  were not processed because neither of these
terms had a concept entry in the terminology file.

The ID field (i.e. CDR*) will be used as both the code and source_dui.

Termtypes OP and IS have suppressible value = O.

AB and MTH_AB termtypes has a status of 'R' (reviewed so it will not trigger editing. Also, they are excluded from matching in termgroups.src.

Mergefacts.src:
---------------

Three types of merges created.  

1.  Merge set = PDQ-SYR
	a)  ID_TYPE* = SRC_ATOM_ID
	b)  Merges between the PT and its LV, SY, CU, ET, CHN, 
	    and IS.

2.  Merge set = PDQ-SY
	a)  ID_TYPE* = SRC_ATOM_ID
	b)  Merges between the PT and its AB and ACR 

3.  Merge set = PDQ-SRC
	a)  ID_TYPE* = SRC_ATOM_ID
	b)  SRC atoms


There will be no mergefact between the FBD or BN
and the PT because NLM does not believe brand names/foreign
brand names to be synonyms of the PT.



Relationships.src:
-----------------

Six types of relationships:

1.  'NT| tradename_of' 
	a)  ID_TYPE* = SRC_ATOM_ID
	b)  Relationship between the BN/FBD and the generic name.

2.  'NT| lab_number_of' 
	a)  ID_TYPE* = SRC_ATOM_ID
	b)  Relationship between the CCN and the PT.

3.  'RT | associated_genetic_condition'
	a)  ID_TYPE1 = CODE_SOURCE
	b)  ID_TYPE2 = CODE_SOURCE
	c)  Relationship between the PT and the RelatedTermName.

4.  'RT | has_component' 
	a)  ID_TYPE1 = CODE_SOURCE
	b)  ID_TYPE2 = CODE_SOURCE 
	c)  Relationship between the PT and the RelatedTermName.

5.  'SFO/LFO| has_expanded_form' 
	a)  ID_TYPE1 = SOURCE_ATOM_ID 
	b)  ID_TYPE2 = SOURCE_ATOM_ID
	c)  Relationship created between the PT and its ACR.

6.  'SY' 
	a)  ID_TYPE1 = SOURCE_ATOM_ID 
	b)  ID_TYPE2 = SOURCE_ATOM_ID
	c)  Relationship created between the PT and its AB.


No broader/narrower relationships (other than those above) need to be 
created in relationships.src since they will be represented in contexts.

No relationships between the PT and the RelatedTermName if the
RelationshipType = 'Related protocol selection criteria' per NCI.


Attributes.src:
----------------

For all attributes, ID_TYPE = SRC_ATOM_ID.

Mapping:

CONTEXTS
CAS Registry name	| CAS_REGISTRY
IND Code		| IND_CODE 
NSC number		| NSC_CODE
Date First Published	| DATE_FIRST_PUBLISHED
Date Last Modified   	| DATE_LAST_MODIFIED
LegacyPDQID	     	| PID		
MenuParent           	| MENU_PARENT
MenuParent ref         	| not processed
MenuType             	| MENU_TYPE
Related protocol selection criteria | PXC
SemanticType		| ORIG_STY
SemanticType		| STY
brand names (BN/FBD)	| LEXICAL_TAG; default value = TRD
Chemical code name	| LEXICAL_TAG; default value = LAB
NCIMetathesaurusConceptID | NCI_ID
ParentTermName ref | not processed
ExternalRef 		| DEFINITION; removed xml tagging & kept html tagging
MenuItem SortOrder      | not processed

PXC attribute will be created for entries with a Relationship type =
Related protocol selection criteria.

Selected PDQ semantic types mapped to UMLS semantic types.  
UMLS semantic types will win upon insertion. Note:  Some PDQ records
have multiple STY fields.  When these get mapped to UMLS stys, in some
cases, duplicates are created.  For example,

CDR0000042022 (complementary and alternative therapy)
STY=Preventive intervention/procedure
STY=Cancer therapy modality

Both are mapped to the UMLS sty of 'Therapeutic or Preventive
Procedure' creating duplicate STY fields.
The script removes the dups but for QA purposes this should
be factored in.

The original STY assigned is kept in ATN=ORIG_STY. 

FULL-MULTIPLE-NOSIBS contexts were created for all entries that had a
parent (ParentTermName and ParentTermType fields).  Orphans were
not included.

MenuType and MenuParent will use the SAID of the PreferredName.

BNs and FBDs will have the attribute of 'LEXICAL_TAG|TRD' and the
default sty=Pharmacologic Substance.

CCNs will have the attribute of 'LEXICAL_TAG|LAB'.


B.  Mapping of source data:

PreferredName     | PT
NCIMetathesaurusConceptID| NCI_ID 
TermTypeName      | Indicates usage of a term. See below.
OtherTermName     | add'l terms
OtherNameType     | Determines termgroup of OtherTermName. See below.
ID                | CDR* code; source_dui & code in classes*
ParentTermName    | BT
ParentTermNameRef | not processed
ParentType        | ISA
RelatedTermName   | Related term
RelatedTermNameRef | CDR* code of the related term; RT rel to the
		    PreferredName.
RelationshipType  | Relationship attribute (has_component...)
LegacyPDQID       | PID in attributes
SemanticType      | STY
SemanticType ref  | CDR* code of the STY; not mapped
DefinitionText    | DEFINITION
DefinitionType    | not processed
ExternalRef       | xml tagging removed, html tagging kept 
Date First Published|Used in attributes.src
Date Last Modified| Used in attributes.src
MenuParent        | Used in attr*src; occurs multi. times in a
			file; linked to the PT
MenuParentRef     | not processed
MenuType          | Same as MenuParent
MenuItem SortOrder| not processed
DisplayName       | SYR mergefact to the PreferredName 
			Can be different that the PreferredName.
			Can have multiple DisplayName fields w/in an entry.
			Mapped as an ET in classes.


TermTypeName field:
Header term     | HT
Protocol selection criteria |PSC
Semantic type   | HT 
Obsolete term   | OP
empty termtypename field | PT


OtherNameType field:

lexical variant | LV
synonym         | SY
abbreviation    | AB
acronym         | ACR
common usage    | CU
foreign brand name | FBD
US brand name   | BN
obsolete name   | IS
Chemical structure name | CHN
Chemical code name	| CCN
broader         | not processed
subtype         | not processed
related string  | not processed
spanish         | not processed.
CAS Registry name | mapped as an attribute
IND code	| mapped as an attribute
NSC number	| mapped as an attribute




C.  META UI fields:

Indicate what source data (if any) is being used to populate the following fields:

CODE: CDR#
SAUI: n/a
SCUI: CDR# 
SDUI: n/a 

D.  Additional data added during Meta construction
	NONE

	1.  Semantic types.  
		1.  STYs provided with the data.
		2.  NCI specified a list of STYs that should be mapped to UMLS
		    STYs.
		3.  All atoms with a termtype of BN or FBD will be assigned a
		    default STY = Pharmacologic Substance.

IV.  Data problems --  Examples. Lists are not comprehensive.
Duplicate values were removed during the inversion process. Other issues 
need to be addressed.

1)  There are a number of CDR*.xml records that create a relationship 
to CDR0000040490 but there is no CDR0000040490.xml record. 
To resolve, all relationships using CDR0000040490 were removed. 

Other invalid CDR#s CDR0000042951, CDR0000042258. Approx. 119 relationships affected.


2)  Duplicate atoms and attributes within concepts.  Removed during 
inversion.

3) End of line characters within concepts.

DOCTYPE Term &#62$
&#60Term id="CDR0000483132" LegacyPDQID="" NCIThesaurusConceptID="C61321"&#62&#60Preferre
dName&#62palladium-bacteriopheophorbide&#60/PreferredName&#62
...

&#60DefinitionText&#62...and necrosis. $Check for &#60ExternalRef xref="http://www.cancer
.gov...

V.  SRC and Metadata:

</PRE>
<HR>
<ADDRESS>Contact: <A HREF="mailto:reg@msdinc.com"> quans </A></ADDRESS>
<ADDRESS>Created: 11/14/2018
 </ADDRESS>
<ADDRESS>Last Updated: 11/14/2018
 </ADDRESS>
<ADDRESS><A HREF="http://unimed.nlm.nih.gov">Meta News Home</A></ADDRESS>

<!-- These comments are used by the What's new Generator -->
<!-- Changed On: 2018/11/14 -->
<!-- Changed by: quans -->
<!-- Change Note: si_proposal_PDQ_2018_10_27.html -->
<!-- Fresh for: 1 month -->
</BODY>
</HTML>
